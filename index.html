<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Connect - Your Social Media Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --light: #f9fafb;
            --border: #e5e7eb;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark);
        }

        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Auth Pages */
        .auth-container {
            max-width: 450px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .auth-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            padding: 40px 30px;
            text-align: center;
            color: white;
        }

        .auth-header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .auth-header p {
            opacity: 0.9;
        }

        .auth-body {
            padding: 40px 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
            color: var(--dark);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-google {
            background: white;
            color: var(--dark);
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-google:hover {
            border-color: var(--primary);
            background: var(--light);
        }

        .divider {
            text-align: center;
            margin: 25px 0;
            position: relative;
        }

        .divider::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            width: 100%;
            height: 1px;
            background: var(--border);
        }

        .divider span {
            background: white;
            padding: 0 15px;
            position: relative;
            font-size: 14px;
            color: #6b7280;
        }

        .link {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: #6b7280;
        }

        .link a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }

        .link a:hover {
            text-decoration: underline;
        }

        /* Main App Layout */
        .app-container {
            display: none;
            background: var(--light);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .app-container.active {
            display: flex;
            height: 90vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }

        .sidebar-header h2 {
            font-size: 24px;
        }

        .nav-menu {
            flex: 1;
            padding: 20px 0;
            overflow-y: auto;
        }

        .nav-item {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--dark);
            font-weight: 500;
        }

        .nav-item:hover {
            background: var(--light);
            color: var(--primary);
        }

        .nav-item.active {
            background: rgba(102, 126, 234, 0.1);
            color: var(--primary);
            border-right: 3px solid var(--primary);
        }

        .nav-item svg {
            width: 24px;
            height: 24px;
        }

        .user-profile {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-info h4 {
            font-size: 14px;
            margin-bottom: 3px;
        }

        .user-info p {
            font-size: 12px;
            color: #6b7280;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .content-header {
            padding: 20px 30px;
            background: white;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .content-header h2 {
            font-size: 24px;
        }

        .content-body {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
        }

        /* Feed */
        .create-post {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .create-post textarea {
            width: 100%;
            border: none;
            resize: none;
            font-size: 16px;
            min-height: 80px;
            padding: 15px;
            border-radius: 10px;
            background: var(--light);
            margin-bottom: 15px;
        }

        .create-post-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .post-actions-left {
            display: flex;
            gap: 15px;
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
            color: #6b7280;
        }

        .action-btn:hover {
            background: var(--light);
            color: var(--primary);
        }

        .action-btn svg {
            width: 20px;
            height: 20px;
        }

        .btn-post {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-post:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        /* Post Card */
        .post-card {
            background: white;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            overflow: hidden;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .post-header {
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .post-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .post-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .post-user-info h4 {
            font-size: 15px;
            margin-bottom: 3px;
        }

        .post-user-info p {
            font-size: 12px;
            color: #6b7280;
        }

        .post-content {
            padding: 0 20px 20px;
        }

        .post-content p {
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .post-image {
            width: 100%;
            max-height: 500px;
            object-fit: cover;
            border-radius: 10px;
        }

        .post-stats {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            border-top: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
            font-size: 14px;
            color: #6b7280;
        }

        .post-actions {
            padding: 10px 20px;
            display: flex;
            justify-content: space-around;
        }

        .post-action-btn {
            flex: 1;
            background: none;
            border: none;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
            color: #6b7280;
            font-weight: 600;
        }

        .post-action-btn:hover {
            background: var(--light);
        }

        .post-action-btn.liked {
            color: var(--danger);
        }

        .post-action-btn svg {
            width: 22px;
            height: 22px;
        }

        /* Chat */
        .chat-container {
            display: flex;
            height: 100%;
            background: white;
            border-radius: 15px;
            overflow: hidden;
        }

        .chat-list {
            width: 350px;
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
        }

        .chat-search {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }

        .chat-search input {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
        }

        .chat-items {
            flex: 1;
            overflow-y: auto;
        }

        .chat-item {
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 1px solid var(--border);
        }

        .chat-item:hover {
            background: var(--light);
        }

        .chat-item.active {
            background: rgba(102, 126, 234, 0.1);
        }

        .chat-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            position: relative;
        }

        .chat-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .online-indicator {
            width: 12px;
            height: 12px;
            background: var(--success);
            border: 2px solid white;
            border-radius: 50%;
            position: absolute;
            bottom: 0;
            right: 0;
        }

        .chat-info {
            flex: 1;
        }

        .chat-info h4 {
            font-size: 14px;
            margin-bottom: 3px;
        }

        .chat-info p {
            font-size: 13px;
            color: #6b7280;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .chat-time {
            font-size: 12px;
            color: #6b7280;
        }

        .chat-window {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            display: flex;
            gap: 10px;
            max-width: 70%;
        }

        .message.sent {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .message-content {
            background: var(--light);
            padding: 12px 15px;
            border-radius: 15px;
        }

        .message.sent .message-content {
            background: var(--primary);
            color: white;
        }

        .message-text {
            font-size: 14px;
            line-height: 1.5;
        }

        .message-time {
            font-size: 11px;
            color: #6b7280;
            margin-top: 5px;
        }

        .message.sent .message-time {
            color: rgba(255,255,255,0.7);
        }

        .chat-input {
            padding: 15px 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 25px;
        }

        .send-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .send-btn:hover {
            background: var(--secondary);
            transform: scale(1.1);
        }

        /* Dating */
        .dating-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            padding: 20px;
        }

        .dating-card {
            width: 400px;
            height: 600px;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            position: relative;
        }

        .dating-card-image {
            width: 100%;
            height: 70%;
            object-fit: cover;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 80px;
        }

        .dating-card-info {
            padding: 25px;
        }

        .dating-card-info h3 {
            font-size: 26px;
            margin-bottom: 5px;
        }

        .dating-card-info p {
            color: #6b7280;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .dating-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .dating-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .dating-btn:hover {
            transform: scale(1.1);
        }

        .dating-btn.pass {
            background: white;
            color: var(--danger);
            border: 2px solid var(--danger);
        }

        .dating-btn.like {
            background: var(--danger);
            color: white;
        }

        .dating-btn svg {
            width: 30px;
            height: 30px;
        }

        /* Profile */
        .profile-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .profile-header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .profile-avatar-large {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 60px;
            font-weight: 600;
        }

        .profile-avatar-large img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .profile-details h2 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .profile-stats {
            display: flex;
            gap: 30px;
            margin: 20px 0;
        }

        .stat {
            text-align: center;
        }

        .stat h3 {
            font-size: 24px;
            color: var(--primary);
        }

        .stat p {
            font-size: 14px;
            color: #6b7280;
            margin-top: 5px;
        }

        .profile-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
            padding: 10px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }

        .btn-secondary:hover {
            background: var(--primary);
            color: white;
        }

        /* Notifications */
        .notification-list {
            background: white;
            border-radius: 15px;
            overflow: hidden;
        }

        .notification-item {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: 15px;
            align-items: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .notification-item:hover {
            background: var(--light);
        }

        .notification-item.unread {
            background: rgba(102, 126, 234, 0.05);
        }

        .notification-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .notification-icon.like {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .notification-icon.comment {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .notification-icon.follow {
            background: rgba(102, 126, 234, 0.1);
            color: var(--primary);
        }

        .notification-content {
            flex: 1;
        }

        .notification-content p {
            font-size: 14px;
            margin-bottom: 5px;
        }

        .notification-time {
            font-size: 12px;
            color: #6b7280;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Alert */
        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .alert-error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        /* Hidden */
        .hidden {
            display: none !important;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }

            .sidebar-header h2,
            .nav-item span,
            .user-info {
                display: none;
            }

            .chat-list {
                width: 80px;
            }

            .chat-info,
            .chat-time {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Registration Page -->
        <div id="registerPage" class="auth-container">
            <div class="auth-header">
                <h1>üöÄ Join Social Connect</h1>
                <p>Create your account and start connecting</p>
            </div>
            <div class="auth-body">
                <div id="registerAlert"></div>
                <form id="registerForm">
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" id="regEmail" placeholder="your@email.com" required>
                    </div>
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="regUsername" placeholder="Choose a username" required>
                    </div>
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" id="regFullName" placeholder="Your full name" required>
                    </div>
                    <div class="form-group">
                        <label>Date of Birth</label>
                        <input type="date" id="regDob" required>
                    </div>
                    <div class="form-group">
                        <label>Gender</label>
                        <select id="regGender">
                            <option value="">Select gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                            <option value="prefer_not_to_say">Prefer not to say</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Bio (Optional)</label>
                        <textarea id="regBio" placeholder="Tell us about yourself..." rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Account</button>
                </form>
                <div class="divider"><span>OR</span></div>
                <button class="btn btn-google" onclick="googleLogin()">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Continue with Google
                </button>
                <div class="link">
                    Already have an account? <a href="#" onclick="showOTPPage()">Sign In</a>
                </div>
            </div>
        </div>

        <!-- OTP Verification Page -->
        <div id="otpPage" class="auth-container hidden">
            <div class="auth-header">
                <h1>‚úâÔ∏è Check Your Email</h1>
                <p>Enter the OTP we sent to your email</p>
            </div>
            <div class="auth-body">
                <div id="otpAlert"></div>
                <form id="otpForm">
                    <div class="form-group">
                        <label>Enter OTP Code</label>
                        <input type="text" id="otpCode" placeholder="123456" maxlength="6" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Verify & Continue</button>
                </form>
                <div class="link">
                    <a href="#" onclick="showRegisterPage()">Back to Registration</a>
                </div>
            </div>
        </div>

        <!-- Main App -->
        <div id="appContainer" class="app-container">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <h2>Social Connect</h2>
                </div>
                <nav class="nav-menu">
                    <div class="nav-item active" onclick="showSection('feed')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                        </svg>
                        <span>Home</span>
                    </div>
                    <div class="nav-item" onclick="showSection('messages')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                        </svg>
                        <span>Messages</span>
                    </div>
                    <div class="nav-item" onclick="showSection('dating')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                        </svg>
                        <span>Dating</span>
                    </div>
                    <div class="nav-item" onclick="showSection('notifications')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                        </svg>
                        <span>Notifications</span>
                    </div>
                    <div class="nav-item" onclick="showSection('profile')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                        <span>Profile</span>
                    </div>
                </nav>
                <div class="user-profile">
                    <div class="user-avatar" id="sidebarAvatar">U</div>
                    <div class="user-info">
                        <h4 id="sidebarUsername">Username</h4>
                        <p id="sidebarEmail">user@email.com</p>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <div class="content-header">
                    <h2 id="contentTitle">Home Feed</h2>
                    <button class="btn-secondary" onclick="logout()">Logout</button>
                </div>
                <div class="content-body">
                    <!-- Feed Section -->
                    <div id="feedSection" class="content-section">
                        <div class="create-post">
                            <textarea id="postContent" placeholder="What's on your mind?"></textarea>
                            <div class="create-post-actions">
                                <div class="post-actions-left">
                                    <button class="action-btn" onclick="document.getElementById('postImageInput').click()">
                                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                        </svg>
                                        Photo
                                    </button>
                                    <input type="file" id="postImageInput" accept="image/*" style="display: none" onchange="handlePostImage(this)">
                                </div>
                                <button class="btn-post" onclick="createPost()">Post</button>
                            </div>
                            <div id="postImagePreview"></div>
                        </div>
                        <div id="feedPosts"></div>
                    </div>

                    <!-- Messages Section -->
                    <div id="messagesSection" class="content-section hidden">
                        <div class="chat-container">
                            <div class="chat-list">
                                <div class="chat-search">
                                    <input type="text" placeholder="Search conversations...">
                                </div>
                                <div class="chat-items" id="chatList">
                                    <!-- Chat items will be loaded here -->
                                </div>
                            </div>
                            <div class="chat-window">
                                <div class="chat-header">
                                    <div class="chat-avatar">
                                        <span id="chatUserInitial">?</span>
                                    </div>
                                    <div class="chat-info">
                                        <h4 id="chatUsername">Select a chat</h4>
                                        <p id="chatUserStatus">Online</p>
                                    </div>
                                </div>
                                <div class="chat-messages" id="chatMessages">
                                    <div style="text-align: center; color: #6b7280; padding: 40px;">
                                        Select a conversation to start messaging
                                    </div>
                                </div>
                                <div class="chat-input">
                                    <input type="text" id="messageInput" placeholder="Type a message..." onkeypress="handleMessageEnter(event)">
                                    <button class="send-btn" onclick="sendMessage()">
                                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Dating Section -->
                    <div id="datingSection" class="content-section hidden">
                        <div class="dating-container">
                            <div class="dating-card" id="datingCard">
                                <div class="dating-card-image" id="datingImage">üë§</div>
                                <div class="dating-card-info">
                                    <h3 id="datingName">Loading...</h3>
                                    <p id="datingBio">Swipe to discover people nearby</p>
                                    <div class="dating-actions">
                                        <button class="dating-btn pass" onclick="swipe('pass')">
                                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                            </svg>
                                        </button>
                                        <button class="dating-btn like" onclick="swipe('like')">
                                            <svg fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notifications Section -->
                    <div id="notificationsSection" class="content-section hidden">
                        <div class="notification-list" id="notificationList">
                            <!-- Notifications will be loaded here -->
                        </div>
                    </div>

                    <!-- Profile Section -->
                    <div id="profileSection" class="content-section hidden">
                        <div class="profile-container">
                            <div class="profile-header">
                                <div class="profile-avatar-large" id="profileAvatar">U</div>
                                <div class="profile-details">
                                    <h2 id="profileUsername">Username</h2>
                                    <p id="profileBio">Bio goes here...</p>
                                    <div class="profile-stats">
                                        <div class="stat">
                                            <h3 id="postsCount">0</h3>
                                            <p>Posts</p>
                                        </div>
                                        <div class="stat">
                                            <h3 id="followersCount">0</h3>
                                            <p>Followers</p>
                                        </div>
                                        <div class="stat">
                                            <h3 id="followingCount">0</h3>
                                            <p>Following</p>
                                        </div>
                                    </div>
                                    <div class="profile-actions">
                                        <button class="btn-secondary" onclick="document.getElementById('profilePicInput').click()">
                                            Change Picture
                                        </button>
                                        <input type="file" id="profilePicInput" accept="image/*" style="display: none" onchange="uploadProfilePicture(this)">
                                    </div>
                                </div>
                            </div>
                            <div id="userPosts"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const API_BASE_URL = 'http://localhost:8000';
        let accessToken = localStorage.getItem('access_token');
        let refreshToken = localStorage.getItem('refresh_token');
        let currentUser = JSON.parse(localStorage.getItem('user') || '{}');
        let websocket = null;
        let currentChatUserId = null;
        let datingProfiles = [];
        let currentDatingIndex = 0;
        let selectedPostImage = null;

        // Initialize
        window.onload = function() {
            if (accessToken) {
                initApp();
            } else {
                showRegisterPage();
            }
        };

        // Helper Functions
        function showAlert(elementId, message, type = 'success') {
            const alertDiv = document.getElementById(elementId);
            alertDiv.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
            setTimeout(() => alertDiv.innerHTML = '', 5000);
        }

        function showLoading(elementId) {
            const element = document.getElementById(elementId);
            element.innerHTML = '<div class="loading"><div class="spinner"></div><p>Loading...</p></div>';
        }

        // Page Navigation
        function showRegisterPage() {
            document.getElementById('registerPage').classList.remove('hidden');
            document.getElementById('otpPage').classList.add('hidden');
            document.getElementById('appContainer').classList.remove('active');
        }

        function showOTPPage() {
            document.getElementById('registerPage').classList.add('hidden');
            document.getElementById('otpPage').classList.remove('hidden');
        }

        function showApp() {
            document.getElementById('registerPage').classList.add('hidden');
            document.getElementById('otpPage').classList.add('hidden');
            document.getElementById('appContainer').classList.add('active');
        }

        // Registration
        document.getElementById('registerForm').onsubmit = async function(e) {
            e.preventDefault();
            
            const data = {
                email: document.getElementById('regEmail').value,
                username: document.getElementById('regUsername').value,
                full_name: document.getElementById('regFullName').value,
                date_of_birth: document.getElementById('regDob').value,
                gender: document.getElementById('regGender').value || null,
                bio: document.getElementById('regBio').value || null
            };

            try {
                const response = await fetch(`${API_BASE_URL}/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (result.success) {
                    localStorage.setItem('pending_email', data.email);
                    showAlert('registerAlert', 'OTP sent to your email! Check your inbox.', 'success');
                    setTimeout(() => showOTPPage(), 2000);
                } else {
                    showAlert('registerAlert', result.detail || 'Registration failed', 'error');
                }
            } catch (error) {
                showAlert('registerAlert', 'Network error. Please try again.', 'error');
            }
        };

        // OTP Verification
        document.getElementById('otpForm').onsubmit = async function(e) {
            e.preventDefault();
            
            const email = localStorage.getItem('pending_email');
            const otp = document.getElementById('otpCode').value;

            try {
                const response = await fetch(`${API_BASE_URL}/auth/verify-otp`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, otp })
                });

                const result = await response.json();

                if (result.success) {
                    accessToken = result.access_token;
                    refreshToken = result.refresh_token;
                    currentUser = result.user;

                    localStorage.setItem('access_token', accessToken);
                    localStorage.setItem('refresh_token', refreshToken);
                    localStorage.setItem('user', JSON.stringify(currentUser));
                    localStorage.removeItem('pending_email');

                    showAlert('otpAlert', 'Account created! Redirecting...', 'success');
                    setTimeout(() => {
                        showApp();
                        initApp();
                    }, 1500);
                } else {
                    showAlert('otpAlert', result.detail || 'Invalid OTP', 'error');
                }
            } catch (error) {
                showAlert('otpAlert', 'Network error. Please try again.', 'error');
            }
        };

        // Google Login
        async function googleLogin() {
            alert('Google Login: Please implement Firebase authentication in your frontend.\n\n1. Add Firebase SDK\n2. Get ID token\n3. Send to /auth/google endpoint');
        }

        // Initialize App
        async function initApp() {
            showApp();
            updateUserProfile();
            loadFeed();
            connectWebSocket();
        }

        // Update User Profile Display
        function updateUserProfile() {
            const initial = currentUser.username ? currentUser.username[0].toUpperCase() : 'U';
            document.getElementById('sidebarAvatar').textContent = initial;
            document.getElementById('sidebarUsername').textContent = currentUser.username || 'Username';
            document.getElementById('sidebarEmail').textContent = currentUser.email || 'email@example.com';
            document.getElementById('profileAvatar').textContent = initial;
            document.getElementById('profileUsername').textContent = currentUser.username || 'Username';
        }

        // WebSocket Connection
        function connectWebSocket() {
            if (!currentUser.id) return;

            websocket = new WebSocket(`ws://localhost:8000/ws/${currentUser.id}`);

            websocket.onopen = () => {
                console.log('WebSocket connected');
            };

            websocket.onmessage = (event) => {
                const data = JSON.parse(event.data);
                console.log('WebSocket message:', data);

                if (data.type === 'message') {
                    handleIncomingMessage(data);
                } else if (data.type === 'notification') {
                    showNotificationToast(data);
                } else if (data.type === 'user_status') {
                    updateUserStatus(data.user_id, data.status);
                }
            };

            websocket.onerror = (error) => {
                console.error('WebSocket error:', error);
            };

            websocket.onclose = () => {
                console.log('WebSocket disconnected');
                // Reconnect after 5 seconds
                setTimeout(connectWebSocket, 5000);
            };
        }

        // Section Navigation
        function showSection(section) {
            // Update nav items
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            event.currentTarget.classList.add('active');

            // Hide all sections
            document.querySelectorAll('.content-section').forEach(sec => sec.classList.add('hidden'));

            // Show selected section
            const sectionMap = {
                'feed': 'feedSection',
                'messages': 'messagesSection',
                'dating': 'datingSection',
                'notifications': 'notificationsSection',
                'profile': 'profileSection'
            };

            const titleMap = {
                'feed': 'Home Feed',
                'messages': 'Messages',
                'dating': 'Dating',
                'notifications': 'Notifications',
                'profile': 'Profile'
            };

            document.getElementById(sectionMap[section]).classList.remove('hidden');
            document.getElementById('contentTitle').textContent = titleMap[section];

            // Load section data
            if (section === 'messages') loadChats();
            if (section === 'dating') loadDatingProfiles();
            if (section === 'notifications') loadNotifications();
            if (section === 'profile') loadProfile();
        }

        // Feed Functions
        async function loadFeed() {
            showLoading('feedPosts');

            try {
                const response = await fetch(`${API_BASE_URL}/feed?page=1&limit=20`, {
                    headers: { 'Authorization': `Bearer ${accessToken}` }
                });

                const result = await response.json();

                if (result.success) {
                    displayPosts(result.posts);
                }
            } catch (error) {
                console.error('Error loading feed:', error);
            }
        }

        function displayPosts(posts) {
            const feedPosts = document.getElementById('feedPosts');
            
            if (posts.length === 0) {
                feedPosts.innerHTML = '<p style="text-align: center; color: #6b7280; padding: 40px;">No posts yet. Start by creating one!</p>';
                return;
            }

            feedPosts.innerHTML = posts.map(post => `
                <div class="post-card">
                    <div class="post-header">
                        <div class="post-avatar">${post.username[0].toUpperCase()}</div>
                        <div class="post-user-info">
                            <h4>${post.username}${post.is_verified ? ' ‚úì' : ''}</h4>
                            <p>${new Date(post.created_at).toLocaleDateString()}</p>
                        </div>
                    </div>
                    <div class="post-content">
                        <p>${post.content}</p>
                        ${post.media_url ? `<img src="${API_BASE_URL}/assets/posts/${post.media_url}" class="post-image" alt="Post image">` : ''}
                    </div>
                    <div class="post-stats">
                        <span>${post.likes_count} likes</span>
                        <span>${post.comments_count} comments</span>
                    </div>
                    <div class="post-actions">
                        <button class="post-action-btn ${post.is_liked ? 'liked' : ''}" onclick="likePost(${post.id})">
                            <svg fill="${post.is_liked ? 'currentColor' : 'none'}" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                            </svg>
                            Like
                        </button>
                        <button class="post-action-btn">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                            </svg>
                            Comment
                        </button>
                        <button class="post-action-btn">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                            </svg>
                            Share
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function handlePostImage(input) {
            if (input.files && input.files[0]) {
                selectedPostImage = input.files[0];
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('postImagePreview').innerHTML = `
                        <div style="margin-top: 15px; position: relative;">
                            <img src="${e.target.result}" style="max-width: 100%; border-radius: 10px;">
                            <button onclick="removePostImage()" style="position: absolute; top: 10px; right: 10px; background: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">‚úï</button>
                        </div>
                    `;
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function removePostImage() {
            selectedPostImage = null;
            document.getElementById('postImageInput').value = '';
            document.getElementById('postImagePreview').innerHTML = '';
        }

        async function createPost() {
            const content = document.getElementById('postContent').value.trim();
            
            if (!content && !selectedPostImage) {
                alert('Please write something or add an image');
                return;
            }

            const formData = new FormData();
            formData.append('content', content);
            formData.append('post_type', 'post');
            if (selectedPostImage) {
                formData.append('file', selectedPostImage);
            }

            try {
                const response = await fetch(`${API_BASE_URL}/posts`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${accessToken}` },
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    document.getElementById('postContent').value = '';
                    removePostImage();
                    loadFeed();
                    alert('Post created successfully!');
                }
            } catch (error) {
                console.error('Error creating post:', error);
                alert('Failed to create post');
            }
        }

        async function likePost(postId) {
            try {
                const response = await fetch(`${API_BASE_URL}/posts/${postId}/like`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${accessToken}` }
                });

                const result = await response.json();
                if (result.success) {
                    loadFeed();
                }
            } catch (error) {
                console.error('Error liking post:', error);
            }
        }

        // Chat Functions
        async function loadChats() {
            // This would load conversations - for demo, we'll show sample data
            document.getElementById('chatList').innerHTML = `
                <div class="chat-item" onclick="openChat(2, 'John Doe')">
                    <div class="chat-avatar">
                        J
                        <div class="online-indicator"></div>
                    </div>
                    <div class="chat-info">
                        <h4>John Doe</h4>
                        <p>Hey, how are you?</p>
                    </div>
                    <div class="chat-time">2m</div>
                </div>
                <div class="chat-item" onclick="openChat(3, 'Jane Smith')">
                    <div class="chat-avatar">JS</div>
                    <div class="chat-info">
                        <h4>Jane Smith</h4>
                        <p>See you tomorrow!</p>
                    </div>
                    <div class="chat-time">1h</div>
                </div>
            `;
        }

        function openChat(userId, username) {
            currentChatUserId = userId;
            document.getElementById('chatUserInitial').textContent = username[0];
            document.getElementById('chatUsername').textContent = username;
            loadMessages(userId);
        }

        async function loadMessages(userId) {
            try {
                const response = await fetch(`${API_BASE_URL}/messages/${userId}`, {
                    headers: { 'Authorization': `Bearer ${accessToken}` }
                });

                const result = await response.json();

                if (result.success) {
                    displayMessages(result.messages);
                }
            } catch (error) {
                console.error('Error loading messages:', error);
            }
        }

        function displayMessages(messages) {
            const chatMessages = document.getElementById('chatMessages');
            
            if (messages.length === 0) {
                chatMessages.innerHTML = '<p style="text-align: center; color: #6b7280; padding: 40px;">No messages yet. Say hi!</p>';
                return;
            }

            chatMessages.innerHTML = messages.reverse().map(msg => `
                <div class="message ${msg.sender_id === currentUser.id ? 'sent' : ''}">
                    <div class="message-avatar">${msg.sender_id === currentUser.id ? currentUser.username[0].toUpperCase() : '?'}</div>
                    <div class="message-content">
                        <div class="message-text">${msg.content}</div>
                        <div class="message-time">${new Date(msg.created_at).toLocaleTimeString()}</div>
                    </div>
                </div>
            `).join('');

            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function handleIncomingMessage(data) {
            if (data.sender_id === currentChatUserId) {
                loadMessages(currentChatUserId);
            }
        }

        function handleMessageEnter(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const content = input.value.trim();

            if (!content || !currentChatUserId) return;

            try {
                const response = await fetch(`${API_BASE_URL}/messages`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${accessToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        receiver_id: currentChatUserId,
                        content: content,
                        message_type: 'text'
                    })
                });

                const result = await response.json();

                if (result.success) {
                    input.value = '';
                    loadMessages(currentChatUserId);
                }
            } catch (error) {
                console.error('Error sending message:', error);
            }
        }

        // Dating Functions
        async function loadDatingProfiles() {
            try {
                const response = await fetch(`${API_BASE_URL}/dating/discover?page=1&limit=10`, {
                    headers: { 'Authorization': `Bearer ${accessToken}` }
                });

                const result = await response.json();

                if (result.success) {
                    datingProfiles = result.profiles;
                    currentDatingIndex = 0;
                    showDatingProfile();
                }
            } catch (error) {
                console.error('Error loading dating profiles:', error);
            }
        }

        function showDatingProfile() {
            if (currentDatingIndex >= datingProfiles.length) {
                document.getElementById('datingName').textContent = 'No more profiles';
                document.getElementById('datingBio').textContent = 'Check back later for more matches!';
                document.getElementById('datingImage').textContent = 'üéâ';
                return;
            }

            const profile = datingProfiles[currentDatingIndex];
            document.getElementById('datingName').textContent = `${profile.full_name}, ${profile.age || '??'}`;
            document.getElementById('datingBio').textContent = profile.bio || 'No bio available';
            document.getElementById('datingImage').textContent = profile.username[0].toUpperCase();
        }

        async function swipe(action) {
            if (currentDatingIndex >= datingProfiles.length) return;

            const profile = datingProfiles[currentDatingIndex];

            try {
                const response = await fetch(`${API_BASE_URL}/dating/swipe`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${accessToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        target_user_id: profile.id,
                        action: action
                    })
                });

                const result = await response.json();

                if (result.success && result.is_match) {
                    alert(`üéâ It's a match with ${profile.full_name}!`);
                }

                currentDatingIndex++;
                showDatingProfile();
            } catch (error) {
                console.error('Error swiping:', error);
            }
        }

        // Notifications
        async function loadNotifications() {
            showLoading('notificationList');

            try {
                const response = await fetch(`${API_BASE_URL}/notifications`, {
                    headers: { 'Authorization': `Bearer ${accessToken}` }
                });

                const result = await response.json();

                if (result.success) {
                    displayNotifications(result.notifications);
                }
            } catch (error) {
                console.error('Error loading notifications:', error);
            }
        }

        function displayNotifications(notifications) {
            const list = document.getElementById('notificationList');

            if (notifications.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #6b7280; padding: 40px;">No notifications yet</p>';
                return;
            }

            list.innerHTML = notifications.map(notif => `
                <div class="notification-item ${notif.is_read ? '' : 'unread'}">
                    <div class="notification-icon ${notif.notification_type}">
                        ${getNotificationIcon(notif.notification_type)}
                    </div>
                    <div class="notification-content">
                        <p><strong>${notif.username}</strong> ${getNotificationText(notif.notification_type)}</p>
                        <div class="notification-time">${new Date(notif.created_at).toLocaleString()}</div>
                    </div>
                </div>
            `).join('');
        }

        function getNotificationIcon(type) {
            const icons = {
                'like': '‚ù§Ô∏è',
                'comment': 'üí¨',
                'follow': 'üë§',
                'message': '‚úâÔ∏è',
                'match': 'üíò'
            };
            return icons[type] || 'üîî';
        }

        function getNotificationText(type) {
            const texts = {
                'like': 'liked your post',
                'comment': 'commented on your post',
                'follow': 'started following you',
                'message': 'sent you a message',
                'match': 'matched with you'
            };
            return texts[type] || 'sent you a notification';
        }

        function showNotificationToast(data) {
            // Simple toast notification
            alert(`New notification: ${data.message}`);
        }

        function updateUserStatus(userId, status) {
            // Update user online status in chat list
            console.log(`User ${userId} is now ${status}`);
        }

        // Profile Functions
        async function loadProfile() {
            try {
                const response = await fetch(`${API_BASE_URL}/auth/me`, {
                    headers: { 'Authorization': `Bearer ${accessToken}` }
                });

                const result = await response.json();

                if (result.success) {
                    const user = result.user;
                    document.getElementById('profileUsername').textContent = user.username;
                    document.getElementById('profileBio').textContent = user.bio || 'No bio yet';
                    
                    // In a real app, you'd fetch these counts
                    document.getElementById('postsCount').textContent = '0';
                    document.getElementById('followersCount').textContent = '0';
                    document.getElementById('followingCount').textContent = '0';
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }

        async function uploadProfilePicture(input) {
            if (!input.files || !input.files[0]) return;

            const formData = new FormData();
            formData.append('file', input.files[0]);

            try {
                const response = await fetch(`${API_BASE_URL}/profile/upload-picture`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${accessToken}` },
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    alert('Profile picture updated!');
                    loadProfile();
                }
            } catch (error) {
                console.error('Error uploading profile picture:', error);
                alert('Failed to upload profile picture');
            }
        }

        // Logout
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('access_token');
                localStorage.removeItem('refresh_token');
                localStorage.removeItem('user');
                
                if (websocket) {
                    websocket.close();
                }

                accessToken = null;
                refreshToken = null;
                currentUser = {};
                
                showRegisterPage();
            }
        }

        // Auto-refresh token
        setInterval(async () => {
            if (refreshToken) {
                try {
                    const response = await fetch(`${API_BASE_URL}/auth/refresh`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ refresh_token: refreshToken })
                    });

                    const result = await response.json();

                    if (result.success) {
                        accessToken = result.access_token;
                        localStorage.setItem('access_token', accessToken);
                    }
                } catch (error) {
                    console.error('Error refreshing token:', error);
                }
            }
        }, 50 * 60 * 1000); // Refresh every 50 minutes
    </script>
</body>
</html>
